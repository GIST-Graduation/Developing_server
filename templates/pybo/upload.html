{% extends 'base.html' %}

{% block content %}
    {% if upload_complete %}
        <table border=1>
           <thead>
              <tr>
                 <th style="width: 200px; border: 1px solid #000000;">분류</th>
                 <th style="width: 200px; border: 1px solid #000000;">카테고리</th>
                 <th style="width: 200px; border: 1px solid #000000;">필요학점</th>
                 <th style="width: 200px; border: 1px solid #000000;">수강학점</th>
                 <th style="width: 200px; border: 1px solid #000000;">비고</th>
              </tr>
           </thead>
        </table>
        {% for course,j in course_list.items %}
        <table border=1>
            <tbody><!-- 기본 한 개 -->
                  <td style="width: 200px; border: 1px solid #000000; " rowspan={{ j|length|add:"2" }}>{{ course }}</td>
                  {% for k in j %}
                      <tr>
                      {% for w in k %}
                      <td style="width: 200px; border: 1px solid #000000;">{{ w }}</td>
                      {% endfor %}
                      </tr>
                  {% endfor %}

        {% endfor %}
              <!-- 나머지 -->
            </tbody>
        </table>
    {% else %}
        <form method="post" enctype="multipart/form-data">
            <div class="file-droppable">
                <div>Drag-n-drop some file here</div>
                <span>&times;</span>
                {% csrf_token %}
                <input type="file" name="document" id="file_enter">
            </div>
        <button type="submit">Upload</button>
        </form>
    {% endif %}
{% endblock %}
{% block script %}
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          document.querySelectorAll('.file-droppable').forEach(function(droppable) {
            var originalText = droppable.querySelector('div').innerHTML;
            var input = droppable.querySelector('input');
            var fileChanged = function() {
              var files = input.files;
              if (files.length) {
                droppable.querySelector('span').style.display = 'block';
                droppable.querySelector('div').innerHTML = '';
                        for (var i = 0; i < files.length; i++) {
                            droppable.querySelector('div').innerHTML += files[i].name + '<br>';
                }
                droppable.classList.add('filled');
              } else {
                droppable.querySelector('div').innerHTML = originalText;
                droppable.classList.remove('filled');
                droppable.querySelector('span').style.display = 'none';
              }
            };
            input.addEventListener('change', fileChanged);
            fileChanged(input);
            droppable.querySelector('span').addEventListener('click', function() {
                  input.value = '';
                fileChanged(input);
            });
          });
        });
    </script>
{% endblock %}